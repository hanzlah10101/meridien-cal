<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <title>Login - Meridien Calendar</title>
    <style>
      :root {
        --bg: #0f172a; /* slate-900 */
        --card: #111827; /* gray-900 */
        --muted: #94a3b8; /* slate-400 */
        --text: #f1f1f1; /* brighter text-200 */
        --accent: #b8860b; /* dark gold */
        --accent-dark: #b8860b; /* dark gold */
        --danger: #ef4444; /* red */
        --ring: rgba(212, 175, 55, 0.45);
        --shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
        --radius: 18px;
      }
      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Noto Sans,
          Ubuntu, Cantarell, "Helvetica Neue", Arial, "Apple Color Emoji",
          "Segoe UI Emoji";
        background: radial-gradient(
          1000px 600px at 50% -10%,
          #1f2937 0%,
          var(--bg) 50%
        );
        color: var(--text);
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
      }

      .login-container {
        width: 100%;
        max-width: 500px; /* Increased from 400px */
        padding: 20px;
        display: flex;
        flex-direction: column;
        gap: 24px;
      }

      .login-card {
        background: #0b1220;
        border: 1px solid #1f2937;
        border-radius: var(--radius);
        padding: 32px;
        box-shadow: var(--shadow);
        display: flex;
        flex-direction: column;
        gap: 24px;
      }

      .login-header {
        text-align: center;
      }

      .login-title {
        font-size: 28px;
        font-weight: 700;
        color: var(--accent);
        margin: 0 0 8px 0;
        letter-spacing: 0.2px;
      }

      .login-subtitle {
        font-size: 14px;
        color: var(--muted);
        margin: 0;
      }

      .form-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin-bottom: 4px; /* Added margin for better spacing */
      }

      .form-submit {
        margin-top: 16px; /* Add gap before submit button */
      }

      label {
        font-size: 14px;
        color: var(--muted);
        font-weight: 600;
        letter-spacing: 0.3px;
      }

      input {
        width: 100%;
        background: #0f172a;
        color: var(--text);
        border: 1px solid #263247;
        border-radius: 14px;
        padding: 16px 20px;
        font: inherit;
        outline: none;
        transition: 0.2s border-color;
        font-size: 15px;
        line-height: 1.4;
      }

      input:focus {
        border-color: var(--accent);
      }

      input.error {
        border-color: var(--danger);
        background: rgba(239, 68, 68, 0.05);
      }

      /* Remove the default invalid styling */
      input:invalid {
        border-color: #263247; /* Keep normal border */
        box-shadow: none;
      }

      /* Only show error styling when explicitly marked */
      input:invalid.error {
        border-color: var(--danger);
      }

      .btn {
        appearance: none;
        border: 1px solid transparent;
        background: #1a1a1a;
        color: var(--text);
        padding: 16px 20px;
        border-radius: 14px;
        cursor: pointer;
        box-shadow: var(--shadow);
        transition: 0.2s transform, 0.2s background, 0.2s border-color;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        font-weight: 600;
        font-size: 15px;
        text-align: center;
        width: 100%;
        min-height: 54px;
      }

      .btn:hover:not(:disabled) {
        transform: translateY(-1px);
      }

      .btn:active:not(:disabled) {
        transform: translateY(0);
      }

      .btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }

      .btn.primary {
        background: linear-gradient(135deg, var(--accent), var(--accent-dark));
        border: none;
        color: #000;
        font-weight: 700;
      }

      .error-message {
        background: rgba(239, 68, 68, 0.1);
        border: 1px solid rgba(239, 68, 68, 0.3);
        color: var(--danger);
        padding: 12px 16px;
        border-radius: 12px;
        font-size: 14px;
        text-align: center;
        display: none;
      }

      .error-message.show {
        display: block;
      }

      /* Loading states */
      .loading {
        opacity: 0.6;
        pointer-events: none;
        position: relative;
      }

      .btn.loading {
        color: transparent;
      }

      .btn.loading::after {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 20px;
        height: 20px;
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top-color: #000;
        animation: spin 1s linear infinite;
        z-index: 10;
      }

      @keyframes spin {
        to {
          transform: translate(-50%, -50%) rotate(360deg);
        }
      }

      .brand-logo {
        width: 60px;
        height: 60px;
        background: linear-gradient(135deg, var(--accent), var(--accent-dark));
        border-radius: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 16px auto;
        font-size: 24px;
        font-weight: 700;
        color: #000;
      }

      @media (max-width: 480px) {
        .login-container {
          padding: 16px;
        }

        .login-card {
          padding: 24px;
        }
      }
    </style>
  </head>
  <body>
    <div class="login-container">
      <div class="login-card">
        <div class="login-header">
          <div class="brand-logo">M</div>
          <h1 class="login-title">Welcome Back</h1>
          <p class="login-subtitle">Sign in to access your calendar</p>
        </div>

        <div class="error-message" id="error-message"></div>

        <form id="login-form" novalidate>
          <div class="form-group">
            <label for="email">Email Address</label>
            <input
              type="email"
              id="email"
              name="email"
              placeholder="Enter your email"
              required
              autocomplete="email"
            />
          </div>

          <div class="form-group">
            <label for="password">Password</label>
            <input
              type="password"
              id="password"
              name="password"
              placeholder="Enter your password"
              required
              autocomplete="current-password"
            />
          </div>

          <div class="form-submit">
            <button type="submit" class="btn primary" id="login-btn">
              Sign In
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js"
      import {
        getAuth,
        signInWithEmailAndPassword,
        onAuthStateChanged
      } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-auth.js"

      // Firebase config - Replace with your actual config
      const firebaseConfig = {
        apiKey: "AIzaSyDAaZo9T9CVa2yTC-t6_WL4Ljy-Uce_IeE",
        authDomain: "meridien-cal.firebaseapp.com",
        databaseURL:
          "https://meridien-cal-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "meridien-cal",
        storageBucket: "meridien-cal.firebasestorage.app",
        messagingSenderId: "872918390831",
        appId: "1:872918390831:web:f262c134a3f14ee50d0eda",
        measurementId: "G-TQ3SDN7CF6"
      } // Initialize Firebase
      const app = initializeApp(firebaseConfig)
      const auth = getAuth(app)

      // DOM elements
      const loginForm = document.getElementById("login-form")
      const emailInput = document.getElementById("email")
      const passwordInput = document.getElementById("password")
      const loginBtn = document.getElementById("login-btn")
      const errorMessage = document.getElementById("error-message")

      // Show error message
      function showError(message) {
        errorMessage.textContent = message
        errorMessage.classList.add("show")

        // Add error styling to inputs
        emailInput.classList.add("error")
        passwordInput.classList.add("error")
      }

      // Hide error message
      function hideError() {
        errorMessage.classList.remove("show")

        // Remove error styling from inputs
        emailInput.classList.remove("error")
        passwordInput.classList.remove("error")
      }

      // Set loading state
      function setLoading(isLoading) {
        if (isLoading) {
          loginBtn.classList.add("loading")
          loginBtn.disabled = true
          emailInput.disabled = true
          passwordInput.disabled = true
        } else {
          loginBtn.classList.remove("loading")
          loginBtn.disabled = false
          emailInput.disabled = false
          passwordInput.disabled = false
        }
      }

      // Handle form submission
      loginForm.addEventListener("submit", async (e) => {
        e.preventDefault()
        hideError()

        const email = emailInput.value.trim()
        const password = passwordInput.value

        if (!email || !password) {
          showError("Please fill in all fields")
          return
        }

        setLoading(true)

        try {
          const userCredential = await signInWithEmailAndPassword(
            auth,
            email,
            password
          )

          // Get the ID token for API requests
          const idToken = await userCredential.user.getIdToken()

          // Store token in localStorage for API requests
          localStorage.setItem("authToken", idToken)

          // Redirect to main app
          window.location.href = "/"
        } catch (error) {
          console.error("Login error:", error)

          let errorMsg = "Login failed. Please try again."

          switch (error.code) {
            case "auth/user-not-found":
            case "auth/wrong-password":
            case "auth/invalid-credential":
              errorMsg = "Invalid email or password"
              break
            case "auth/user-disabled":
              errorMsg = "Account has been disabled"
              break
            case "auth/too-many-requests":
              errorMsg = "Too many failed attempts. Please try again later."
              break
            case "auth/network-request-failed":
              errorMsg = "Network error. Please check your connection."
              break
          }

          showError(errorMsg)
        } finally {
          setLoading(false)
        }
      })

      // Check if user is already logged in
      onAuthStateChanged(auth, (user) => {
        if (user) {
          // User is signed in, redirect to main app
          window.location.href = "/"
        }
      })

      // Auto-focus email input
      emailInput.focus()
    </script>
  </body>
</html>
